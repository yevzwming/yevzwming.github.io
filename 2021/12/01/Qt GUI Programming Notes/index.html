<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Qt GUI Programming Notes, MING&#39;s blog">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Qt GUI Programming Notes | MING&#39;s blog</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="MING's blog" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>



   <style>
    body{
       background-image: url(https://i.loli.net/2021/09/29/gCS53XoiExDf21w.jpg);
       background-repeat:no-repeat;
       background-size:cover;
       background-attachment:fixed;
    }
</style>



<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.jpg" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">MING&#39;s blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="" class="waves-effect waves-light">

      
      <i class="fas fa-list" style="zoom: 0.6;"></i>
      
      <span>Medias</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/musics">
          
          <i class="fas fa-music" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Musics</span>
        </a>
      </li>
      
      <li>
        <a href="/movies">
          
          <i class="fas fa-film" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Movies</span>
        </a>
      </li>
      
      <li>
        <a href="/books">
          
          <i class="fas fa-book" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Books</span>
        </a>
      </li>
      
      <li>
        <a href="/galleries">
          
          <i class="fas fa-image" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>Galleries</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.jpg" class="logo-img circle responsive-img">
        
        <div class="logo-name">MING&#39;s blog</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-list"></i>
			
			Medias
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/musics " style="margin-left:50px">
				  
				   <i class="fa fas fa-music" style="position: absolute;left:28px" ></i>
			      
		          <span>Musics</span>
                  </a>
                </li>
              
                <li>

                  <a href="/movies " style="margin-left:50px">
				  
				   <i class="fa fas fa-film" style="position: absolute;left:28px" ></i>
			      
		          <span>Movies</span>
                  </a>
                </li>
              
                <li>

                  <a href="/books " style="margin-left:50px">
				  
				   <i class="fa fas fa-book" style="position: absolute;left:28px" ></i>
			      
		          <span>Books</span>
                  </a>
                </li>
              
                <li>

                  <a href="/galleries " style="margin-left:50px">
				  
				   <i class="fa fas fa-image" style="position: absolute;left:28px" ></i>
			      
		          <span>Galleries</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/16.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Qt GUI Programming Notes</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/notes/">
                                <span class="chip bg-color">notes</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-12-01
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1><span id="qt-gui-programming-notes">Qt GUI Programming Notes</span></h1><ul>
<li>Yevzwming  Dec.1 2021</li>
</ul>
<h2><span id="1-helloworld">1. hello,world</span></h2><p>创建一个 widget application, 先认识一下这个main函数：</p>
<p>我们将 main.cpp 修改如下：</p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">#include &lt;QApplication&gt;
#include &lt;QLabel&gt;

int main(int argc, char *argv[])
&#123;
    QApplication app(argc, argv);

    QLabel label(&quot;Hello, world&quot;);
    label.show();

    return app.exec();
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="http://files.devbean.net/images/2012/08/qt-hello-world.png" alt="Qt HelloWorld 程序运行结果"></p>
<p>前两行是 C++ 的 include 语句，这里我们引入的是<code>QApplication</code>以及<code>QLabel</code>这两个类。<code>main()</code>函数中第一句是创建一个<code>QApplication</code>类的实例。对于 Qt 程序来说，<code>main()</code>函数一般以创建 application 对象（GUI 程序是<code>QApplication</code>，非 GUI 程序是<code>QCoreApplication</code>。<code>QApplication</code>实际上是<code>QCoreApplication</code>的子类。）开始，后面才是实际业务的代码。这个对象用于管理 Qt 程序的生命周期，开启事件循环，这一切都是必不可少的。在我们创建了<code>QApplication</code>对象之后，直接创建一个<code>QLabel</code>对象，构造函数赋值“Hello, world”，当然就是能够在<code>QLabel</code>上面显示这行文本。最后调用<code>QLabel</code>的<code>show()</code>函数将其显示出来。<code>main()</code>函数最后，调用<code>app.exec()</code>，开启事件循环。我们现在可以简单地将事件循环理解成一段无限循环。正因为如此，我们在栈上构建了<code>QLabel</code>对象，却能够一直显示在那里（试想，如果不是无限循环，<code>main()</code>函数立刻会退出，<code>QLabel</code>对象当然也就直接析构了）。</p>
<h2><span id="2-信号槽">2. 信号槽</span></h2><p>所谓信号槽，实际就是观察者模式。当某个事件发生之后，比如，按钮检测到自己被点击了一下，它就会发出一个信号（signal）。这种发出是没有目的的，类似广播。如果有对象对这个信号感兴趣，它就会使用连接（connect）函数，意思是，用自己的一个函数（成为槽（slot））来处理这个信号。也就是说，当信号发出时，被连接的槽函数会自动被回调。这就类似观察者模式：当发生了感兴趣的事件，某一个操作就会被自动触发。</p>
<pre class="line-numbers language-none"><code class="language-none">#include &lt;QApplication&gt;
#include &lt;QPushButton&gt;

int main(int argc, char *argv[])
&#123;
    QApplication app(argc, argv);

    QPushButton button(&quot;Quit&quot;);
    QObject::connect(&amp;button, &amp;QPushButton::clicked, &amp;QApplication::quit);
    button.show();

    return app.exec();
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>点击运行，我们会看到一个按钮，上面有“Quit”字样。点击按钮，程序退出。</p>
<p>我们这里要仔细分析<code>QObject::connect()</code>这个函数。</p>
<p>我们先来看看<code>connect()</code>函数最常用的一般形式：</p>
<pre class="line-numbers language-none"><code class="language-none">connect(sender,  signal, receiver, slot);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>connect()</code>一般会使用前面四个参数，第一个是发出信号的对象，第二个是发送对象发出的信号，第三个是接收信号的对象，第四个是接收对象在接收到信号之后所需要调用的函数。也就是说，当 sender 发出了 signal 信号之后，会自动调用 receiver 的 slot 函数。</p>
<p>当我们的 button 发出了<code>clicked()</code>信号时，会调用<code>QApplication</code>的<code>quit()</code>函数，使程序退出。</p>
<p>借助 Qt 5 的信号槽语法，我们可以将一个对象的信号连接到 Lambda 表达式，例如：</p>
<pre class="line-numbers language-none"><code class="language-none">#include &lt;QApplication&gt;
#include &lt;QPushButton&gt;
#include &lt;QDebug&gt;

int main(int argc, char *argv[])
&#123;
    QApplication app(argc, argv);

    QPushButton button(&quot;Quit&quot;);
    QObject::connect(&amp;button, &amp;QPushButton::clicked, [](bool) &#123;
        qDebug() &lt;&lt; &quot;You clicked me!&quot;;
    &#125;);
    button.show();

    return app.exec();
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>注意这里的 Lambda 表达式接收一个 bool 参数，这是因为<code>QPushButton</code>的<code>clicked()</code>信号实际上是有一个参数的。Lambda 表达式中的<code>qDebug()</code>类似于<code>cout</code>，将后面的字符串打印到标准输出。</p>
<h2><span id="3-添加动作">3. 添加动作</span></h2><p>Qt 使用<code>QAction</code>类作为动作。顾名思义，这个类就是代表了窗口的一个“动作”，这个动作可能显示在菜单，作为一个菜单项，当用户点击该菜单项，对用户的点击做出响应；也可能在工具栏，作为一个工具栏按钮，用户点击这个按钮就可以执行相应的操作。有一点值得注意：无论是出现在菜单栏还是工具栏，用户选择之后，所执行的动作应该都是一样的。因此，Qt 并没有专门的菜单项类，只是使用一个<code>QAction</code>类，抽象出公共的动作。当我们把<code>QAction</code>对象添加到菜单，就显示成一个菜单项，添加到工具栏，就显示成一个工具按钮。用户可以通过点击菜单项、点击工具栏按钮、点击快捷键来激活这个动作。</p>
<p><code>QAction</code>包含了图标、菜单文字、快捷键、状态栏文字、浮动帮助等信息。当把一个<code>QAction</code>对象添加到程序中时，Qt 自己选择使用哪个属性来显示，无需我们关心。同时，Qt 能够保证把<code>QAction</code>对象添加到不同的菜单、工具栏时，显示内容是同步的。也就是说，如果我们在菜单中修改了<code>QAction</code>的图标，那么在工具栏上面这个<code>QAction</code>所对应的按钮的图标也会同步修改。</p>
<p>示例：</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F; &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; mainwindow.h
#ifndef MAINWINDOW_H
#define MAINWINDOW_H

#include &lt;QMainWindow&gt;

class MainWindow : public QMainWindow
&#123;
    Q_OBJECT
public:
    MainWindow(QWidget *parent &#x3D; 0);
    ~MainWindow();

private:
    void open();

    QAction *openAction;
&#125;;

#endif &#x2F;&#x2F; MAINWINDOW_H

&#x2F;&#x2F; &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; mainwindow.cpp
#include &lt;QAction&gt;
#include &lt;QMenuBar&gt;
#include &lt;QMessageBox&gt;
#include &lt;QStatusBar&gt;
#include &lt;QToolBar&gt;

#include &quot;mainwindow.h&quot;

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent)
&#123;
    setWindowTitle(tr(&quot;Main Window&quot;));

    openAction &#x3D; new QAction(QIcon(&quot;:&#x2F;images&#x2F;doc-open&quot;), tr(&quot;&amp;Open...&quot;), this);
    openAction-&gt;setShortcuts(QKeySequence::Open);
    openAction-&gt;setStatusTip(tr(&quot;Open an existing file&quot;));
    connect(openAction, &amp;QAction::triggered, this, &amp;MainWindow::open);

    QMenu *file &#x3D; menuBar()-&gt;addMenu(tr(&quot;&amp;File&quot;));
    file-&gt;addAction(openAction);

    QToolBar *toolBar &#x3D; addToolBar(tr(&quot;&amp;File&quot;));
    toolBar-&gt;addAction(openAction);

    statusBar() ;
&#125;

MainWindow::~MainWindow()
&#123;
&#125;

void MainWindow::open()
&#123;
    QMessageBox::information(this, tr(&quot;Information&quot;), tr(&quot;Open&quot;));
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>上面的代码分别属于两个文件：mainwindow.h 和 mainwindow.cpp。为了让 MainWindow 运行起来，我们还需要修改 main() 函数如下：</p>
<pre class="line-numbers language-none"><code class="language-none">int main(int argc, char *argv[])
&#123;
    QApplication app(argc, argv);

    MainWindow win;
    win.show();

    return app.exec();
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="http://files.devbean.net/images/2012/08/mw-action.png" alt="Main Window with Action"></p>
<p>首先，我们在<code>MainWindow</code>类中添加了一个私有函数<code>open()</code>和一个私有变量<code>openAction</code>。在 MainWindow 的构造函数中，第一行我们调用了<code>setWindowTitle()</code>，设置主窗口的标题。注意我们的文本使用<code>tr()</code>函数，这是一个用于 Qt 国际化的函数。在后续章节中我们可以看到，我们可以使用 Qt 提供的国际化工具，将<code>tr()</code>函数的字符串提取出来，进行国际化。由于所需进行国际化的文本应该被大多数人认识，所以，<code>tr()</code>函数里面一般会是英文文本。</p>
<p>然后，我们在堆上创建了<code>openAction</code>对象。在<code>QAction</code>构造函数，我们传入了一个图标、一个文本和 this 指针。我们将在后面的文章中解释 this 指针的含义。</p>
<p><code>QAction</code>第二个参数中，文本值前面有一个 &amp;，意味着这将成为一个快捷键。注意看截图中 File 的 F 有一个下划线。下面一句，我们使用了<code>setShortcut()</code>函数，用于说明这个<code>QAction</code>的快捷键。</p>
<p><code>setStatusTip()</code>则实现了当用户鼠标滑过这个 action 时，会在主窗口下方的状态栏显示相应的提示。</p>
<p>后面的<code>connect()</code>函数，将这个<code>QAction</code>的<code>triggered()</code>信号与<code>MainWindow</code>类的<code>open()</code>函数连接起来。当用户点击了这个<code>QAction</code>时，会自动触发<code>MainWindow</code>的<code>open()</code>函数。这是我们之前已经了解过的。</p>
<p>下面的<code>menuBar()</code>、<code>toolBar()</code>和<code>statusBar()</code>三个是<code>QMainWindow</code>的函数，用于创建并返回菜单栏、工具栏和状态栏。我们可以从代码清楚地看出，我们向菜单栏添加了一个 File 菜单，并且把这个<code>QAction</code>对象添加到这个菜单；同时新增加了一个 File 工具栏，也把<code>QAction</code>对象添加到了这个工具栏。我们可以看到，在菜单中，这个对象被显示成一个菜单项，在工具栏变成了一个按钮。至于状态栏，则是出现在窗口最下方，用于显示动作对象的提示信息的。</p>
<p>我们看这个代码片段：</p>
<pre class="line-numbers language-none"><code class="language-none">openAction &#x3D; new QAction(QIcon(&quot;:&#x2F;images&#x2F;doc-open&quot;), tr(&quot;&amp;Open...&quot;), this);
openAction-&gt;setShortcuts(QKeySequence::Open);
openAction-&gt;setStatusTip(tr(&quot;Open an existing file&quot;));
connect(openAction, &amp;QAction::triggered, this, &amp;MainWindow::open);

QMenu *file &#x3D; menuBar()-&gt;addMenu(tr(&quot;&amp;File&quot;));
file-&gt;addAction(openAction);

QToolBar *toolBar &#x3D; addToolBar(tr(&quot;&amp;File&quot;));
toolBar-&gt;addAction(openAction);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>使用<code>menuBar()</code>函数，Qt 为我们创建了一个菜单栏。<code>menuBar()</code>是<code>QMainWindow</code>提供的函数，因此你是不会在<code>QWidget</code>或者<code>QDialog</code>中找到它的。这个函数会返回窗口的菜单栏，如果没有菜单栏则会新创建一个。这也就解释了，为什么我们可以直接使用<code>menuBar()</code>函数的返回值，毕竟我们并没有创建一个菜单栏对象啊！原来，这就是<code>menuBar()</code>为我们创建好并且返回了的。</p>
<p>Qt 中，表示菜单的类是<code>QMenuBar</code>（你应该已经想到这个名字了）。<code>QMenuBar</code>代表的是窗口最上方的一条菜单栏。我们使用其<code>addMenu()</code>函数为其添加菜单。</p>
<p>当我们创建出来了菜单对象时，就可以把<code>QAction</code>添加到这个菜单上面，也就是<code>addAction()</code>函数的作用。</p>
<p><code>QToolBar</code>部分非常类似。顾名思义，<code>QToolBar</code>就是工具栏。我们使用的是<code>addToolBar()</code>函数添加新的工具栏。为什么前面一个是<code>menuBar()</code>而现在的是<code>addToolBar()</code>呢？因为一个窗口只有一个菜单栏，但是却可能有多个工具栏。如果我们将代码修改一下：</p>
<pre class="line-numbers language-none"><code class="language-none">QToolBar *toolBar &#x3D; addToolBar(tr(&quot;&amp;File&quot;));
toolBar-&gt;addAction(openAction);

QToolBar *toolBar2 &#x3D; addToolBar(tr(&quot;Tool Bar 2&quot;));
toolBar2-&gt;addAction(openAction);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="http://files.devbean.net/images/2012/09/qtoolbar-2.png" alt="在 QMainWindow 中添加两个 QToolBar"></p>
<h2><span id="4-布局管理">4. 布局管理</span></h2><p>看一个例子：</p>
<pre class="line-numbers language-none"><code class="language-none">int main(int argc, char *argv[])
&#123;
    QApplication app(argc, argv);

    QWidget window;
    window.setWindowTitle(&quot;Enter your age&quot;);

    QSpinBox *spinBox &#x3D; new QSpinBox(&amp;window);
    QSlider *slider &#x3D; new QSlider(Qt::Horizontal, &amp;window);
    spinBox-&gt;setRange(0, 130);
    slider-&gt;setRange(0, 130);

    QObject::connect(slider, &amp;QSlider::valueChanged, spinBox, &amp;QSpinBox::setValue);
    void (QSpinBox:: *spinBoxSignal)(int) &#x3D; &amp;QSpinBox::valueChanged;
    QObject::connect(spinBox, spinBoxSignal, slider, &amp;QSlider::setValue);
    spinBox-&gt;setValue(35);

    QHBoxLayout *layout &#x3D; new QHBoxLayout;
    layout-&gt;addWidget(spinBox);
    layout-&gt;addWidget(slider);
    window.setLayout(layout);

    window.show();

    return app.exec();
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="http://files.devbean.net/images/2012/09/layout-demo.png" alt="Qt Layout 原始大小示例"></p>
<p>我们在这段代码中引入了两个新的组件：<code>QSpinBox</code>和<code>QSlider</code>。<code>QSpinBox</code>就是只能输入数字的输入框，并且带有上下箭头的步进按钮。<code>QSlider</code>则是带有滑块的滑竿。我们可以从上面的截图中清楚地辨别出这两个组件。当我们创建了这两个组件的实例之后，我们使用<code>setRange()</code>函数设置其范围。既然我们的窗口标题是“Enter your age（输入你的年龄）”，那么把 range（范围）设置为 0 到 130 应该足够了。</p>
<p>注意connect里参数的顺序不能对调。编译器认为<code>QSpinBox::valueChanged</code>是一个 overloaded 的函数。我们看一下<code>QSpinBox</code>的文档发现，<code>QSpinBox</code>的确有两个信号：</p>
<ul>
<li><code>void valueChanged(int)</code></li>
<li><code>void valueChanged(const QString &amp;)</code></li>
</ul>
<p>当我们使用<code>&amp;QSpinBox::valueChanged</code>取函数指针时，编译器不知道应该取哪一个函数（记住前面我们介绍过的，经过 moc 预处理后，signal 也是一个普通的函数。）的地址，因此报错。解决的方法很简单，编译器不是不能确定哪一个函数吗？那么我们就显式指定一个函数。方法就是，我们创建一个函数指针，这个函数指针参数指定为 int：</p>
<pre class="line-numbers language-none"><code class="language-none">void (QSpinBox:: *spinBoxSignal)(int) &#x3D; &amp;QSpinBox::valueChanged;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>然后我们将这个函数指针作为 signal，与 QSlider 的函数连接。</p>
<p>下面的代码，我们创建了一个<code>QHBoxLayout</code>对象。显然，这就是一个布局管理器。然后将这两个组件都添加到这个布局管理器，并且把该布局管理器设置为窗口的布局管理器。这些代码看起来都是顺理成章的，应该很容易明白。并且，布局管理器很聪明地做出了正确的行为：保持<code>QSpinBox</code>宽度不变，自动拉伸<code>QSlider</code>的宽度。</p>
<p>Qt 提供了几种布局管理器供我们选择：</p>
<ul>
<li><code>QHBoxLayout</code>：按照水平方向从左到右布局；</li>
<li><code>QVBoxLayout</code>：按照竖直方向从上到下布局；</li>
<li><code>QGridLayout</code>：在一个网格中进行布局，类似于 HTML 的 table；</li>
<li><code>QFormLayout</code>：按照表格布局，每一行前面是一段文本，文本后面跟随一个组件（通常是输入框），类似 HTML 的 form；</li>
<li><code>QStackedLayout</code>：层叠的布局，允许我们将几个组件按照 Z 轴方向堆叠，可以形成向导那种一页一页的效果。</li>
</ul>
<h2><span id="5-文件对话框">5. 文件对话框</span></h2><p><code>QMessageBox</code> Qt标准对话框。</p>
<p>下面讨论另外一个标准对话框：<code>QFileDialog</code>，文件对话框。下面例子将使用<code>QFileDialog</code>打开一个文本文件，并将修改过的文件保存到硬盘。</p>
<p>首先创建一个带有文本编辑功能的窗口：</p>
<pre class="line-numbers language-none"><code class="language-none">openAction &#x3D; new QAction(QIcon(&quot;:&#x2F;images&#x2F;file-open&quot;), tr(&quot;&amp;Open...&quot;), this);
openAction-&gt;setShortcuts(QKeySequence::Open);
openAction-&gt;setStatusTip(tr(&quot;Open an existing file&quot;));

saveAction &#x3D; new QAction(QIcon(&quot;:&#x2F;images&#x2F;file-save&quot;), tr(&quot;&amp;Save...&quot;), this);
saveAction-&gt;setShortcuts(QKeySequence::Save);
saveAction-&gt;setStatusTip(tr(&quot;Save a new file&quot;));

QMenu *file &#x3D; menuBar()-&gt;addMenu(tr(&quot;&amp;File&quot;));
file-&gt;addAction(openAction);
file-&gt;addAction(saveAction);

QToolBar *toolBar &#x3D; addToolBar(tr(&quot;&amp;File&quot;));
toolBar-&gt;addAction(openAction);
toolBar-&gt;addAction(saveAction);

textEdit &#x3D; new QTextEdit(this);
setCentralWidget(textEdit);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在菜单和工具栏添加了两个动作：打开和保存。在这里我们添加了一个QTextEdit类，用于显示富文本文件，不仅仅可以显示文本，还可以显示图片和表格等等，在这里先实现纯文本文件。<code>QMainWindow</code>有个<code>setCentralWidget()</code> 函数，可以将一个组件作为窗口的中心组件放在窗口中央显示区。在一个文本编辑器中，文本编辑区就是这个中心组件，用<code>QTextEdit</code>。</p>
<p>在这里<code>connect()</code>的用法如下，为<code>QAction</code>对象添加响应的动作（我们希望打开新的窗口）：</p>
<pre class="line-numbers language-none"><code class="language-none">connect(openAction, &amp;QAction::triggered, this, &amp;MainWindow::openFile);
connect(saveAction, &amp;QAction::triggered, this, &amp;MainWindow::saveFile);
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>重点看<code>openFile()</code>和<code>saveFile()</code>两个函数的代码：</p>
<pre class="line-numbers language-none"><code class="language-none">void MainWindow::openFile()
&#123;
    QString path &#x3D; QFileDialog::getOpenFileName(this, tr(&quot;Open File&quot;), &quot;.&quot;, tr(&quot;Text Files(*.txt)&quot;));
    if(!path.isEmpty()) &#123;
        QFile file(path);
        if (!file.open(QIODevice::ReadOnly | QIODevice::Text)) &#123;
            QMessageBox::warning(this, tr(&quot;Read File&quot;), tr(&quot;Cannot open file:\n%1&quot;).arg(path));
            return;
        &#125;
        QTextStream in(&amp;file);
        textEdit-&gt;setText(in.readAll());
        file.close();
    &#125; else &#123;
        QMessageBox::warning(this, tr(&quot;Path&quot;), tr(&quot;You did not select any file.&quot;));
    &#125;
&#125;

void MainWindow::saveFile()
&#123;
    QString path &#x3D; QFileDialog::getSaveFileName(this, tr(&quot;Save File&quot;), &quot;.&quot;, tr(&quot;Text Files(*.txt)&quot;));
    if(!path.isEmpty()) &#123;
        QFile file(path);
        if (!file.open(QIODevice::WriteOnly | QIODevice::Text)) &#123;
            QMessageBox::warning(this, tr(&quot;Write File&quot;), tr(&quot;Cannot open file:\n%1&quot;).arg(path));
            return;
        &#125;
        QTextStream out(&amp;file);
        out &lt;&lt; textEdit-&gt;toPlainText();
        file.close();
    &#125; else &#123;
        QMessageBox::warning(this, tr(&quot;Path&quot;), tr(&quot;You did not select any file.&quot;));
    &#125;
&#125;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>具体看一下期中的函数：在<code>openFile()</code>函数中，我们用<code>QFileDialog::getOpenFileName()</code>来获取需要打开的文件的路径。函数如下：</p>
<pre class="line-numbers language-none"><code class="language-none">QString getOpenFileName(QWidget * parent &#x3D; 0,
                        const QString &amp; caption &#x3D; QString(),
                        const QString &amp; dir &#x3D; QString(),
                        const QString &amp; filter &#x3D; QString(),
                        QString * selectedFilter &#x3D; 0,
                        Options options &#x3D; 0)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>parent：父窗口。我们前面介绍过，Qt 的标准对话框提供静态函数，用于返回一个模态对话框（在一定程度上这就是外观模式的一种体现）；</li>
<li>caption：对话框标题；</li>
<li>dir：对话框打开时的默认目录，“.” 代表程序运行目录，“/” 代表当前盘符的根目录（特指 Windows 平台；Linux 平台当然就是根目录），这个参数也可以是平台相关的，比如“C:\”等；</li>
<li>filter：过滤器。我们使用文件对话框可以浏览很多类型的文件，但是，很多时候我们仅希望打开特定类型的文件。比如，文本编辑器希望打开文本文件，图片浏览器希望打开图片文件。过滤器就是用于过滤特定的后缀名。如果我们使用“Image Files(<em>.jpg <em>.png)”，则只能显示后缀名是 jpg 或者 png 的文件。如果需要多个过滤器，使用“;;”分割，比如“JPEG Files(</em>.jpg);;PNG Files(</em>.png)”；</li>
<li>selectedFilter：默认选择的过滤器；</li>
<li>options：对话框的一些参数设定，比如只显示文件夹等等，它的取值是<code>enum QFileDialog::Option</code>，每个选项可以使用 | 运算组合起来。</li>
</ul>
<p><code>QFileDialog::getOpenFileName()</code>返回值是选择的文件路径。我们将其赋值给 path。通过判断 path 是否为空，可以确定用户是否选择了某一文件。只有当用户选择了一个文件时，我们才执行下面的操作。</p>
<p>我们创建一个QFile对象，将用户选择的文件路径传递给这个对象。用<code>QFile::open()</code>来打开这个文件，其参数是指定的打开方式，这里我们使用只读方式和文本方式。<code>QFile::open()</code>打开成功返回true, 由此继续下面的操作：使用<code>QTextStream::readAll()</code>读取文件所有内容赋值给<code>QtextEdit</code>显示出来。</p>
<p><code>saveFile()</code>函数也是类似的，最后一步我们用&lt;&lt;重定向，将QTextEdit的内容输出到一个文件中。文件操作我们后续介绍。</p>
<h2><span id="6-事件">6. 事件</span></h2><p>事件（event）是由系统或者 Qt 本身在不同的时刻发出的。当用户按下鼠标、敲下键盘，或者是窗口需要重新绘制的时候，都会发出一个相应的事件。一些事件在对用户操作做出响应时发出，如键盘事件等；另一些事件则是由系统自动发出，如计时器事件。</p>
<p>Qt 中的事件和信号槽却并不是可以相互替代的。信号由具体的对象发出，然后会马上交给由<code>connect()</code>函数连接的槽进行处理；而对于事件，Qt 使用一个事件队列对所有发出的事件进行维护，当新的事件产生时，会被追加到事件队列的尾部。前一个事件完成后，取出后面的事件进行处理。但是，必要的时候，Qt 的事件也可以不进入事件队列，而是直接处理。信号一旦发出，对应的槽函数一定会被执行。但是，事件则可以使用“事件过滤器”进行过滤，对于有些事件进行额外的处理，另外的事件则不关心。总的来说，如果我们<strong>使用</strong>组件，我们关心的是信号槽；如果我们<strong>自定义</strong>组件，我们关心的是事件。因为我们可以通过事件来改变组件的默认操作。比如，如果我们要自定义一个能够响应鼠标事件的<code>EventLabel</code>，我们就需要重写<code>QLabel</code>的鼠标事件，做出我们希望的操作，有可能还得在恰当的时候发出一个类似按钮的<code>clicked()</code>信号（如果我们希望让这个<code>EventLabel</code>能够被其它组件使用）或者其它的信号。</p>
<p>下面看一个例子：</p>
<pre class="line-numbers language-none"><code class="language-none">class EventLabel : public QLabel
&#123;
protected:
    void mouseMoveEvent(QMouseEvent *event);
    void mousePressEvent(QMouseEvent *event);
    void mouseReleaseEvent(QMouseEvent *event);
&#125;;

void EventLabel::mouseMoveEvent(QMouseEvent *event)
&#123;
    this-&gt;setText(QString(&quot;&lt;center&gt;&lt;h1&gt;Move: (%1, %2)&lt;&#x2F;h1&gt;&lt;&#x2F;center&gt;&quot;)
                  .arg(QString::number(event-&gt;x()), QString::number(event-&gt;y())));
&#125;

void EventLabel::mousePressEvent(QMouseEvent *event)
&#123;
    this-&gt;setText(QString(&quot;&lt;center&gt;&lt;h1&gt;Press: (%1, %2)&lt;&#x2F;h1&gt;&lt;&#x2F;center&gt;&quot;)
                  .arg(QString::number(event-&gt;x()), QString::number(event-&gt;y())));
&#125;

void EventLabel::mouseReleaseEvent(QMouseEvent *event)
&#123;
    QString msg;
    msg.sprintf(&quot;&lt;center&gt;&lt;h1&gt;Release: (%d, %d)&lt;&#x2F;h1&gt;&lt;&#x2F;center&gt;&quot;,
                event-&gt;x(), event-&gt;y());
    this-&gt;setText(msg);
&#125;

int main(int argc, char *argv[])
&#123;
    QApplication a(argc, argv);

    EventLabel *label &#x3D; new EventLabel;
    label-&gt;setWindowTitle(&quot;MouseEvent Demo&quot;);
    label-&gt;resize(300, 200);
    label-&gt;show();

    return a.exec();
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>EventLabel</code>继承了<code>QLabel</code>，覆盖了<code>mousePressEvent()</code>、<code>mouseMoveEvent()</code>和<code>mouseReleaseEvent()</code>三个函数。我们并没有添加什么功能，只是在鼠标按下（press）、鼠标移动（move）和鼠标释放（release）的时候，把当前鼠标的坐标值显示在这个<code>Label</code>上面。由于<code>QLabel</code>是支持 HTML 代码的，因此我们直接使用了 HTML 代码来格式化文字。</p>
<p><code>QString</code>的<code>arg()</code>函数可以自动替换掉<code>QString</code>中出现的占位符。其占位符以 % 开始，后面是占位符的位置，例如 %1，%2 这种。</p>
<pre class="line-numbers language-none"><code class="language-none">QString(&quot;[%1, %2]&quot;).arg(x, y);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>语句将会使用 x 替换 %1，y 替换 %2，因此，这个语句生成的<code>QString</code>为 [x, y]。</p>
<p>在<code>mouseReleaseEvent()</code>函数中，我们使用了另外一种<code>QString</code>的构造方法。我们使用类似 C 风格的格式化函数<code>sprintf()</code>来构造<code>QString</code>。</p>
<h2><span id="7-绘制">7. 绘制</span></h2><p>Qt 的绘图系统允许使用相同的 API 在屏幕和其它打印设备上进行绘制。整个绘图系统基于<code>QPainter</code>，<code>QPainterDevice</code>和<code>QPaintEngine</code>三个类。</p>
<p><code>QPainter</code>用来执行绘制的操作；<code>QPaintDevice</code>是一个二维空间的抽象，这个二维空间允许<code>QPainter</code>在其上面进行绘制，也就是<code>QPainter</code>工作的空间；<code>QPaintEngine</code>提供了画笔（<code>QPainter</code>）在不同的设备上进行绘制的统一的接口。<code>QPaintEngine</code>类应用于<code>QPainter</code>和<code>QPaintDevice</code>之间，通常对开发人员是透明的。除非你需要自定义一个设备，否则你是不需要关心<code>QPaintEngine</code>这个类的。我们可以把<code>QPainter</code>理解成画笔；把<code>QPaintDevice</code>理解成使用画笔的地方，比如纸张、屏幕等；而对于纸张、屏幕而言，肯定要使用不同的画笔绘制，为了统一使用一种画笔，我们设计了<code>QPaintEngine</code>类，这个类让不同的纸张、屏幕都能使用一种画笔。</p>
<p>下面我们通过一个实例来介绍<code>QPainter</code>的使用：</p>
<pre class="line-numbers language-none"><code class="language-none">class PaintedWidget : public QWidget
&#123;
    Q_OBJECT
public:
    PaintedWidget(QWidget *parent &#x3D; 0);
protected:
    void paintEvent(QPaintEvent *);
&#125;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">PaintedWidget::PaintedWidget(QWidget *parent) :
    QWidget(parent)
&#123;
    resize(800, 600);
    setWindowTitle(tr(&quot;Paint Demo&quot;));
&#125;

void PaintedWidget::paintEvent(QPaintEvent *)
&#123;
    QPainter painter(this);
    painter.drawLine(80, 100, 650, 500);
    painter.setPen(Qt::red);
    painter.drawRect(10, 10, 100, 400);
    painter.setPen(QPen(Qt::green, 5));
    painter.setBrush(Qt::blue);
    painter.drawEllipse(50, 150, 400, 200);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在构造函数中，我们仅仅设置了窗口的大小和标题。而<code>paintEvent()</code>函数则是绘制的代码。首先，我们在栈上创建了一个<code>QPainter</code>对象，也就是说，每次运行<code>paintEvent()</code>函数的时候，都会重建这个<code>QPainter</code>对象。</p>
<p><code>QPainter</code>接收一个<code>QPaintDevice</code>指针作为参数。<code>QPaintDevice</code>有很多子类，比如<code>QImage</code>，以及<code>QWidget</code>。注意回忆一下，<code>QPaintDevice</code>可以理解成要在哪里去绘制，而现在我们希望画在这个组件，因此传入的是 this 指针。</p>
<p><code>QPainter</code>有很多以 draw 开头的函数，用于各种图形的绘制，比如这里的<code>drawLine()</code>，<code>drawRect()</code>以及<code>drawEllipse()</code>等。当绘制轮廓线时，使用<code>QPainter</code>的<code>pen()</code>属性。比如，我们调用了<code>painter.setPen(Qt::red)</code>将 pen 设置为红色，则下面绘制的矩形具有红色的轮廓线。接下来，我们将 pen 修改为绿色，5 像素宽（<code>painter.setPen(QPen(Qt::green, 5))</code>），又设置了画刷为蓝色。这时候再调用 draw 函数，则是具有绿色 5 像素宽轮廓线、蓝色填充的椭圆。</p>
<p><img src="http://files.devbean.net/images/2012/10/paint-demo.png" alt="绘制示例"></p>
<p>将<code>QPainter</code>的逻辑坐标与<code>QPaintDevice</code>的物理坐标进行映射的工作，是由<code>QPainter</code>的变换矩阵（transformation matrix）、视口（viewport）和窗口（window）完成的。</p>
<p>在 Qt 的坐标系统中，每个像素占据 1x1 的空间。你可以把它想象成一张方格纸，每个小格都是1个像素。方格的焦点定义了坐标，也就是说，像素 (x, y) 的中心位置其实是在 (x + 0.5, y + 0.5) 的位置上。这个坐标系统实际上是一个“半像素坐标系”。我们可以通过下面的示意图来理解这种坐标系：</p>
<p><img src="http://files.devbean.net/images/2012/11/coordinate-system-demo.png" alt="坐标系统图示"></p>
<p>进行一个示例：</p>
<pre class="line-numbers language-none"><code class="language-none">void PaintDemo::paintEvent(QPaintEvent *)
&#123;
    QPainter painter(this);
    painter.fillRect(10, 10, 50, 100, Qt::red);
    painter.save();
    painter.translate(100, 0); &#x2F;&#x2F; 向右平移 100px
    painter.fillRect(10, 10, 50, 100, Qt::yellow);
    painter.restore();
    painter.save();
    painter.translate(300, 0); &#x2F;&#x2F; 向右平移 300px
    painter.rotate(30); &#x2F;&#x2F; 顺时针旋转 30 度
    painter.fillRect(10, 10, 50, 100, Qt::green);
    painter.restore();
    painter.save();
    painter.translate(400, 0); &#x2F;&#x2F; 向右平移 400px
    painter.scale(2, 3); &#x2F;&#x2F; 横坐标单位放大 2 倍，纵坐标放大 3 倍
    painter.fillRect(10, 10, 50, 100, Qt::blue);
    painter.restore();
    painter.save();
    painter.translate(600, 0); &#x2F;&#x2F; 向右平移 600px
    painter.shear(0, 1); &#x2F;&#x2F; 横向不变，纵向扭曲 1 倍
    painter.fillRect(10, 10, 50, 100, Qt::cyan);
    painter.restore();
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Qt 提供了四种坐标变换：平移 translate，旋转 rotate，缩放 scale 和扭曲 shear。在这段代码中，我们首先在 (10, 10) 点绘制一个红色的 50x100 矩形。保存当前状态，将坐标系平移到 (100, 0)，绘制一个黄色的矩形。注意，<code>translate()</code>操作平移的是坐标系，不是矩形。因此，我们还是在 (10, 10) 点绘制一个 50x100 矩形，现在，它跑到了右侧的位置。然后恢复先前状态，也就是把坐标系重新设为默认坐标系（相当于进行<code>translate(-100, 0)</code>），再进行下面的操作。之后也是类似的。由于我们只是保存了默认坐标系的状态，因此我们之后的<code>translate()</code>横坐标值必须增加，否则就会覆盖掉前面的图形。所有这些操作都是针对坐标系的，因此在绘制时，我们提供的矩形的坐标参数都是不变的。</p>
<p><img src="http://files.devbean.net/images/2012/11/coordinate-transformations-demo.png" alt="坐标变换示例"></p>

                
            </div>
            <hr/>

            



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/notes/">
                                    <span class="chip bg-color">notes</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    
        <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '',
        clientSecret: '',
        repo: '',
        owner: '',
        admin: null,
        id: '2021-12-01T12-34-36',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>

    

    
        <link rel="stylesheet" href="/libs/gitment/gitment-default.css">
<link rel="stylesheet" href="/css/gitment.css">

<div class="gitment-card card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="gitment-content" class="card-content"></div>
</div>

<script src="/libs/gitment/gitment.js"></script>
<script>
var gitment = new Gitment({
    id: 'Wed Dec 01 2021 12:34:36 GMT+0800',
    owner: '',
    repo: '',
    oauth: {
        client_id: '',
        client_secret: ''
    }
});

gitment.render('gitment-content');
</script>

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2021/12/02/Data%20Analysis%20and%20Visualization%20of%20POI%20Checking-In%20Data/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/18.jpg" class="responsive-img" alt="Data Analysis and Visualization of POI Checking-In Data">
                        
                        <span class="card-title">Data Analysis and Visualization of POI Checking-In Data</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-12-02
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            zwming
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/notes/">
                        <span class="chip bg-color">notes</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/10/02/%E5%A4%A7%E4%B8%80%E4%B8%8B%E6%80%BB%E7%BB%93/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/2.jpg" class="responsive-img" alt="大一下总结">
                        
                        <span class="card-title">大一下总结</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-10-02
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            zwming
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/summary/">
                        <span class="chip bg-color">summary</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4,h5,h6'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4,h5,h6').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2021</span>
            
            <span id="year">2021</span>
            <a href="/about" target="_blank">zwming</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2021";
                        var startMonth = "9";
                        var startDate = "28";
                        var startHour = "0";
                        var startMinute = "0";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'zh-CN';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/yevzwming" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:2278341884@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2278341884" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2278341884" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
<script type="text/javascript">
    //只在桌面版网页启用特效
    var windowWidth = $(window).width();
    if (windowWidth > 768) {
        document.write('<script type="text/javascript" src="/js/sakura.js"><\/script>');
    }
</script>